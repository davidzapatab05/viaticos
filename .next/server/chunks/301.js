"use strict";exports.id=301,exports.ids=[301],exports.modules={2864:(a,b,c)=>{c.d(b,{E:()=>h});var d=c(48249);c(67484);var e=c(21654),f=c(14490);let g=(0,e.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function h({className:a,variant:b,...c}){return(0,d.jsx)("div",{className:(0,f.cn)(g({variant:b}),a),...c})}},63647:(a,b,c)=>{c.d(b,{BT:()=>j,Wu:()=>k,ZB:()=>i,Zp:()=>g,aR:()=>h,wL:()=>l});var d=c(48249),e=c(67484),f=c(14490);let g=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,f.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...b}));g.displayName="Card";let h=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,f.cn)("flex flex-col space-y-1.5 p-6",a),...b}));h.displayName="CardHeader";let i=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("h3",{ref:c,className:(0,f.cn)("text-2xl font-semibold leading-none tracking-tight",a),...b}));i.displayName="CardTitle";let j=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("p",{ref:c,className:(0,f.cn)("text-sm text-muted-foreground",a),...b}));j.displayName="CardDescription";let k=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,f.cn)("p-6 pt-0",a),...b}));k.displayName="CardContent";let l=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,f.cn)("flex items-center p-6 pt-0",a),...b}));l.displayName="CardFooter"},82223:(a,b,c)=>{c.d(b,{A:()=>$});var d=c(48249),e=c(19099),f=c(67484),g=c(58167),h=c(25297),i=c(2864),j=c(73408),k=c(14490);let l=f.forwardRef(({className:a,...b},c)=>(0,d.jsx)(j.bL,{ref:c,className:(0,k.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...b}));l.displayName=j.bL.displayName,f.forwardRef(({className:a,...b},c)=>(0,d.jsx)(j._V,{ref:c,className:(0,k.cn)("aspect-square h-full w-full",a),...b})).displayName=j._V.displayName;let m=f.forwardRef(({className:a,...b},c)=>(0,d.jsx)(j.H4,{ref:c,className:(0,k.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...b}));m.displayName=j.H4.displayName;var n=c(90110),o=c(24520),p=c(69004),q=c(95581),r=c(189),s=c(8505),t=c(98631),u=c(96029),v=c(9915),w=c(87620),x=c(21654),y=c(46674);let z=w.bL,A=w.l9;w.bm;let B=w.ZL,C=f.forwardRef(({className:a,...b},c)=>(0,d.jsx)(w.hJ,{className:(0,k.cn)("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...b,ref:c}));C.displayName=w.hJ.displayName;let D=(0,x.F)("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),E=f.forwardRef(({side:a="right",className:b,children:c,...e},f)=>(0,d.jsxs)(B,{children:[(0,d.jsx)(C,{}),(0,d.jsxs)(w.UC,{ref:f,className:(0,k.cn)(D({side:a}),b),...e,children:[c,(0,d.jsxs)(w.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[(0,d.jsx)(y.A,{className:"h-4 w-4"}),(0,d.jsx)("span",{className:"sr-only",children:"Close"})]})]})]}));E.displayName=w.UC.displayName;let F=({className:a,...b})=>(0,d.jsx)("div",{className:(0,k.cn)("flex flex-col space-y-2 text-center sm:text-left",a),...b});F.displayName="SheetHeader";let G=f.forwardRef(({className:a,...b},c)=>(0,d.jsx)(w.hE,{ref:c,className:(0,k.cn)("text-lg font-semibold text-foreground",a),...b}));G.displayName=w.hE.displayName;let H=f.forwardRef(({className:a,...b},c)=>(0,d.jsx)(w.VY,{ref:c,className:(0,k.cn)("text-sm text-muted-foreground",a),...b}));H.displayName=w.VY.displayName;var I=c(2116),J=c.n(I),K=c(38679),L=c(19794),M=c(42742),N=c(33740);let O=K.bL,P=K.l9;K.YJ,K.ZL,K.Pb,K.z6,f.forwardRef(({className:a,inset:b,children:c,...e},f)=>(0,d.jsxs)(K.ZP,{ref:f,className:(0,k.cn)("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",b&&"pl-8",a),...e,children:[c,(0,d.jsx)(L.A,{className:"ml-auto h-4 w-4"})]})).displayName=K.ZP.displayName,f.forwardRef(({className:a,...b},c)=>(0,d.jsx)(K.G5,{ref:c,className:(0,k.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...b})).displayName=K.G5.displayName;let Q=f.forwardRef(({className:a,sideOffset:b=4,...c},e)=>(0,d.jsx)(K.ZL,{children:(0,d.jsx)(K.UC,{ref:e,sideOffset:b,className:(0,k.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...c})}));Q.displayName=K.UC.displayName;let R=f.forwardRef(({className:a,inset:b,...c},e)=>(0,d.jsx)(K.q7,{ref:e,className:(0,k.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",b&&"pl-8",a),...c}));R.displayName=K.q7.displayName,f.forwardRef(({className:a,children:b,checked:c,...e},f)=>(0,d.jsxs)(K.H_,{ref:f,className:(0,k.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),checked:c,...e,children:[(0,d.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,d.jsx)(K.VF,{children:(0,d.jsx)(M.A,{className:"h-4 w-4"})})}),b]})).displayName=K.H_.displayName,f.forwardRef(({className:a,children:b,...c},e)=>(0,d.jsxs)(K.hN,{ref:e,className:(0,k.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...c,children:[(0,d.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,d.jsx)(K.VF,{children:(0,d.jsx)(N.A,{className:"h-2 w-2 fill-current"})})}),b]})).displayName=K.hN.displayName;let S=f.forwardRef(({className:a,inset:b,...c},e)=>(0,d.jsx)(K.JU,{ref:e,className:(0,k.cn)("px-2 py-1.5 text-sm font-semibold",b&&"pl-8",a),...c}));S.displayName=K.JU.displayName;let T=f.forwardRef(({className:a,...b},c)=>(0,d.jsx)(K.wv,{ref:c,className:(0,k.cn)("-mx-1 my-1 h-px bg-muted",a),...b}));T.displayName=K.wv.displayName;var U=c(94358),V=c(13576),W=c(27073),X=c(10368);let Y="BDWGuvH457kmZGwCdzsL_VDTkRuA6xfUK1su36Iojaie9xmVjWMvQth4G8tYYjGMJ2WioAh6eH9T66Y4Dt3pxyw";function Z(){let{isGracePeriod:a,timeLeft:b,activeDateDisplay:c,isLastHour:i}=(0,U.J)(),j=(0,e.useRouter)(),{appUser:k}=(0,g.A)(),{isSubscribed:l,subscribe:m,loading:n}=function(){let[a,b]=(0,f.useState)(!1),[c,d]=(0,f.useState)(!1),[e,g]=(0,f.useState)(null),[h,i]=(0,f.useState)("default");return{isSubscribed:a,subscribe:async()=>{if(!Y){console.error("VAPID Public Key not found"),g("Configuraci\xf3n de notificaciones incompleta");return}d(!0),g(null);try{let a=await navigator.serviceWorker.ready;if("default"===Notification.permission){let a=await Notification.requestPermission();if(i(a),"granted"!==a)throw Error("Permiso de notificaciones denegado")}let c=await a.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:function(a){let b="=".repeat((4-a.length%4)%4),c=(a+b).replace(/\-/g,"+").replace(/_/g,"/"),d=window.atob(c),e=new Uint8Array(d.length);for(let a=0;a<d.length;++a)e[a]=d.charCodeAt(a);return e}(Y)});await (0,X.subscribeToNotifications)(c),b(!0),console.log("User subscribed to push notifications")}catch(a){console.error("Failed to subscribe the user: ",a),g("Error al suscribirse a las notificaciones")}finally{d(!1)}},loading:c,error:e,permission:h}}();return b?(0,d.jsx)("div",{className:`${i?"bg-orange-600":"bg-blue-600"} text-white px-2 py-1 shadow-md relative z-50`,children:(0,d.jsxs)("div",{className:"container mx-auto flex flex-col sm:flex-row items-center justify-between gap-1 text-xs sm:text-sm",children:[(0,d.jsxs)("div",{className:"flex flex-wrap justify-center items-center gap-x-3 gap-y-0.5 text-center sm:text-left",children:[(0,d.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,d.jsx)(V.A,{className:"h-3 w-3 sm:h-3.5 sm:w-3.5 animate-pulse"}),(0,d.jsxs)("span",{className:"font-bold whitespace-nowrap",children:["Cierre en: ",b]})]}),(0,d.jsx)("span",{className:"hidden sm:inline",children:"|"}),(0,d.jsxs)("span",{className:"opacity-90 text-[10px] sm:text-xs",children:["Fecha: ",(0,d.jsx)("strong",{children:c})]})]}),(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[!l&&(0,d.jsx)(h.$,{variant:"ghost",size:"icon",className:"h-6 w-6 text-white hover:bg-white/20 hover:text-white",onClick:m,disabled:n,title:"Activar notificaciones en segundo plano",children:n?(0,d.jsx)("span",{className:"animate-spin",children:"âŒ›"}):(0,d.jsx)(W.A,{className:"h-3.5 w-3.5"})}),(0,d.jsx)(h.$,{variant:"secondary",size:"sm",className:`h-5 sm:h-6 text-[10px] sm:text-xs px-2 bg-white border-none ${i?"text-orange-700 hover:bg-orange-50":"text-blue-700 hover:bg-blue-50"}`,onClick:()=>j.push("/nuevo-viatico"),children:"Registrar viatico"})]})]})}):null}function $({children:a}){let{user:b,signOut:c,appUser:j}=(0,g.A)(),w=(0,e.usePathname)(),x=(0,e.useRouter)(),[y,B]=(0,f.useState)(!1),C=async()=>{(await c()).success&&x.push("/login"),B(!1)},D=[{path:"/dashboard",label:"Inicio",icon:n.A}];j&&D.push({path:"/nuevo-viatico",label:"Nuevo Vi\xe1tico",icon:o.A},{path:"/mis-viaticos",label:"Mis Vi\xe1ticos",icon:p.A}),(j?.role==="admin"||j?.role==="super_admin")&&D.push({path:"/admin",label:"Admin",icon:q.A});let I=()=>j?.role==="super_admin"?(0,d.jsx)(r.A,{className:"h-3.5 w-3.5 text-yellow-500"}):j?.role==="admin"?(0,d.jsx)(s.A,{className:"h-3.5 w-3.5 text-blue-500"}):(0,d.jsx)(t.A,{className:"h-3.5 w-3.5 text-muted-foreground"}),K=()=>j?.role==="super_admin"?"Super Admin":j?.role==="admin"?"Admin":"Usuario",L=()=>j?.role==="super_admin"?"default":j?.role==="admin"?"secondary":"outline",M=j?.displayName||b?.displayName||b?.email?.split("@")[0]||"Usuario",N=M?.charAt(0).toUpperCase()||b?.email?.charAt(0).toUpperCase()||"U";return(0,d.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,d.jsx)(Z,{}),(0,d.jsx)("header",{className:"sticky top-0 z-50 w-full border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:(0,d.jsxs)("div",{className:"container flex h-16 items-center",children:[(0,d.jsxs)(J(),{href:"/dashboard",className:"mr-6 flex items-center space-x-2",children:[(0,d.jsx)("div",{className:"w-8 h-8 rounded-lg bg-primary flex items-center justify-center",children:(0,d.jsx)("span",{className:"text-lg",children:"\uD83D\uDCB0"})}),(0,d.jsx)("span",{className:"hidden font-bold sm:inline-block",children:"Gesti\xf3n de Vi\xe1ticos"})]}),(0,d.jsx)("nav",{className:"hidden md:flex flex-1 items-center space-x-6 text-sm font-medium",children:D.map(a=>{a.icon;let b=w===a.path;return(0,d.jsx)(J(),{href:a.path,className:(0,k.cn)("transition-colors hover:text-foreground/80",b?"text-foreground":"text-foreground/60"),children:a.label},a.path)})}),(0,d.jsxs)("div",{className:"flex items-center gap-4",children:[(0,d.jsxs)("div",{className:"hidden md:flex items-center gap-2",children:[j?.role&&(0,d.jsxs)(i.E,{variant:L(),className:"text-xs",children:[I(),(0,d.jsx)("span",{className:"ml-1",children:K()})]}),(0,d.jsxs)(O,{children:[(0,d.jsx)(P,{asChild:!0,children:(0,d.jsx)(h.$,{variant:"ghost",className:"relative h-8 w-8 rounded-full",children:(0,d.jsx)(l,{className:"h-8 w-8",children:(0,d.jsx)(m,{children:N})})})}),(0,d.jsxs)(Q,{className:"w-56",align:"end",forceMount:!0,children:[(0,d.jsx)(S,{className:"font-normal",children:(0,d.jsxs)("div",{className:"flex flex-col space-y-1",children:[(0,d.jsx)("p",{className:"text-sm font-medium leading-none",children:M}),(0,d.jsx)("p",{className:"text-xs leading-none text-muted-foreground",children:b?.email})]})}),(0,d.jsx)(T,{}),(0,d.jsxs)(S,{className:"flex items-center gap-2",children:[I(),(0,d.jsxs)("span",{className:"text-xs",children:["Rol: ",K()]})]}),(0,d.jsx)(T,{}),(0,d.jsxs)(R,{onClick:C,children:[(0,d.jsx)(u.A,{className:"mr-2 h-4 w-4"}),(0,d.jsx)("span",{children:"Cerrar sesi\xf3n"})]})]})]})]}),(0,d.jsxs)(z,{open:y,onOpenChange:B,children:[(0,d.jsx)(A,{asChild:!0,children:(0,d.jsx)(h.$,{variant:"ghost",size:"icon",className:"md:hidden",children:(0,d.jsx)(v.A,{className:"h-5 w-5"})})}),(0,d.jsxs)(E,{side:"right",children:[(0,d.jsxs)(F,{children:[(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(l,{className:"h-10 w-10",children:(0,d.jsx)(m,{children:N})}),(0,d.jsxs)("div",{className:"flex flex-col items-start",children:[(0,d.jsx)(G,{className:"text-sm",children:M}),(0,d.jsx)(H,{className:"text-xs",children:b?.email})]})]}),j?.role&&(0,d.jsxs)(i.E,{variant:L(),className:"text-xs w-fit mt-2",children:[I(),(0,d.jsx)("span",{className:"ml-1",children:K()})]})]}),(0,d.jsxs)("nav",{className:"flex flex-col gap-4 mt-8",children:[D.map(a=>{let b=a.icon,c=w===a.path;return(0,d.jsxs)(J(),{href:a.path,onClick:()=>B(!1),className:(0,k.cn)("flex items-center gap-3 rounded-lg px-3 py-2 text-sm font-medium transition-colors",c?"bg-primary text-primary-foreground":"text-muted-foreground hover:bg-accent hover:text-accent-foreground"),children:[(0,d.jsx)(b,{className:"h-4 w-4"}),a.label]},a.path)}),(0,d.jsxs)(h.$,{variant:"outline",className:"justify-start gap-3",onClick:C,children:[(0,d.jsx)(u.A,{className:"h-4 w-4"}),"Cerrar sesi\xf3n"]})]})]})]})]})]})}),(0,d.jsx)("main",{className:"container py-6",children:a})]})}},94358:(a,b,c)=>{c.d(b,{J:()=>e});var d=c(67484);function e(){let[a,b]=(0,d.useState)(new Date),[c,e]=(0,d.useState)(""),[f,g]=(0,d.useState)(""),[h,i]=(0,d.useState)(!1),[j,k]=(0,d.useState)(!1),[l,m]=(0,d.useState)(!0);return(0,d.useRef)(null),{activeDate:a,activeDateDisplay:c,timeLeft:f,isGracePeriod:h,isLastHour:j,loading:l}}c(13238),c(32844),c(20330),c(7151),c(47011),c(86747),c(61323)}};